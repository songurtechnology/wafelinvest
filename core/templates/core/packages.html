{% extends 'base.html' %}
{% load widget_tweaks %}

{% block title %}Yatırım Paketleri - WafelInvest{% endblock %}

{% block meta_description %}
WafelInvest yatırım paketleri ile sabit getiri fırsatlarını keşfedin. %50’den %100’e kadar avantajlı paket seçenekleriyle güvenli yatırım yapın.
{% endblock %}

{% block meta_keywords %}
yatırım paketleri, sabit getiri, stroopwafel yatırımı, güvenli yatırım, aylık getiri, WafelInvest
{% endblock %}

{% block content %}
<div class="container py-5" role="main" aria-label="Yatırım Paketleri Sayfası">

  <h1 class="text-center text-gradient display-5 fw-bold mb-5" style="font-family: 'Poppins', sans-serif;">
    Güvenli ve Kârlı Yatırım Paketleri
  </h1>

  {% if messages %}
    <div class="mb-4" role="alert" aria-live="polite">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show shadow-sm rounded-4" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Kapat"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <h2 class="mb-4 text-center">{{ category }}</h2>

  <div class="row g-4" aria-label="{{ category }} yatırım paketleri listesi">
    {% for package in packages %}
      <div class="col-14 col-md-8 col-lg-6">
        <section class="card h-100 shadow-lg rounded-4 border-0 hover-card" tabindex="0" aria-labelledby="package-{{ package.id }}-name" role="region">
          <header class="card-header border-0 bg-transparent text-center pt-4 pb-2">
            <h2 id="package-{{ package.id }}-name" class="text-uppercase fw-bold" style="color:
                {% if 'Basic' in package.name %}#20c997
                {% elif 'Premium' in package.name %}#0d6efd
                {% elif 'Master' in package.name %}#fd7e14
                {% else %}#6c757d
                {% endif %};
                letter-spacing: 1.5px;">
              {{ package.name }}
            </h2>
            <span class="badge rounded-pill fs-6 px-3 py-2 mt-2 text-bg-light">
              <i class="bi 
                {% if 'Basic' in package.name %}bi-currency-euro
                {% elif 'Premium' in package.name %}bi-star-fill
                {% elif 'Master' in package.name %}bi-award-fill
                {% else %}bi-archive
                {% endif %} me-1" aria-hidden="true"></i> Paket Detayları
            </span>
          </header>

          <div class="card-body px-4 py-3">
            <h3 class="fw-bold text-center mb-4" style="font-family: 'Montserrat', sans-serif;">
              €{{ package.price|default_if_none:"-"|floatformat:2 }}
            </h3>

            <ul class="list-unstyled small text-muted mb-4">
              <li>
                <i class="bi bi-clock me-2" aria-hidden="true"></i>
                <strong>Süre:</strong> 
                {% if package.duration_days %}
                  {{ package.duration_days }} gün
                {% else %}
                  Bilgi yok
                {% endif %}
              </li>

              <li>
                <i class="bi bi-graph-up-arrow me-2" aria-hidden="true"></i>
                <strong>Getiri:</strong> 
                {% if package.profit_percent %}
                  %{{ package.profit_percent }}
                {% else %}
                  Bilgi yok
                {% endif %}
              </li>

              <li>
                <i class="bi bi-shield-check me-2" aria-hidden="true"></i>
                <strong>İptal:</strong> 30 Gün İçinde %30 İade
              </li>
            </ul>

            <div class="collapse mb-3" id="desc-{{ package.id }}" aria-live="polite" aria-atomic="true" aria-expanded="false">
              <p class="text-muted small" style="white-space: pre-line;">
                {{ package.description|default:"Bu paketin açıklaması henüz girilmedi." }}
              </p>
            </div>
          </div>

          <div class="d-grid gap-2 px-4 pb-3">
            <a href="{% url 'package_detail' package.id %}" 
               class="btn btn-outline-info fw-medium shadow-sm rounded-pill" 
               role="button"
               aria-label="{{ package.name }} paketinin detaylarını göster">
              📘 Detaylı Bilgi
            </a>
            <button class="btn btn-outline-secondary rounded-pill" 
                    type="button" 
                    data-bs-toggle="collapse" 
                    data-bs-target="#desc-{{ package.id }}" 
                    aria-expanded="false" 
                    aria-controls="desc-{{ package.id }}"
                    aria-label="{{ package.name }} paketinin özet bilgisini göster veya gizle">
              Özet Bilgiyi Göster / Gizle
            </button>
          </div>

          <footer class="card-footer bg-white border-0 px-4 pb-4 pt-3">
            <form method="post" action="{% url 'invest' package.id %}">
              {% csrf_token %}
              <button type="submit" 
                      class="btn btn-primary w-100 py-3 fw-semibold rounded-pill shadow-sm btn-hover"
                      aria-label="{{ package.name }} paketine yatırım yap">
                🚀 Yatırıma Başla
              </button>
            </form>
          </footer>
        </section>
      </div>
    {% empty %}
      <div class="col-12 text-center">
        <p class="text-muted fs-5 fst-italic">Şu an için tanımlı bir yatırım paketi bulunmamaktadır.</p>
      </div>
    {% endfor %}
  </div>

  <!-- Sayfaya özel stil -->
  <style>
    .hover-card {
      transition: all 0.3s ease-in-out;
    }

    .hover-card:hover,
    .hover-card:focus {
      transform: translateY(-8px) scale(1.01);
      box-shadow: 0 1rem 2rem rgba(0, 0, 0, 0.08);
      outline: none;
    }

    .text-gradient {
      background: linear-gradient(to right, #0d6efd, #20c997);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .btn-hover:hover,
    .btn-hover:focus {
      background-color: #0b5ed7 !important;
      box-shadow: 0 0.5rem 1rem rgba(11, 94, 215, 0.3);
      outline: none;
    }

    @media (max-width: 768px) {
      h1 {
        font-size: 1.9rem !important;
      }

      h2 {
        font-size: 1.6rem !important;
      }
    }

    @media (max-width: 576px) {
      .card-body, .card-footer {
        padding: 1.2rem !important;
      }
    }
  </style>

</div>
{% endblock %}
